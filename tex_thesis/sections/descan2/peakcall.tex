The Peak Caller (\lstinline{findPeaks} method) takes as input a set of alignment files (BAM \cite{Li2009} or BED format) with the code of the reference genome (i.e. \textit{mm10} for Mus Musculus version 10) and several additional parameters, useful for the peak detection setup.

The alignement data are stored as GenomicRangesList \cite{Lawrence2013}, where each element represents a file. 
In order to facilitate the parallelization of the computations over the chromosomes, the list is re-arranged as a list of chromosomes of GenomicRangesList, where each element represents a file containing just the GenomicRanges of the specific chromosome (see section \ref{sec:descan2addfeat}.

On this data structure the algorithm firstly divides each chromosome as bins of \lstinline{binSize} parameter length (default is 50bp) and then computes the reads coverage on the bins with moving scan windows, spanning from \lstinline{minWin} to \lstinline{maxWin} parameters of \lstinline{binSize} interval.

In order to be able to catch small and spread peaks the algorithm computes the coverage also using windows of two different lengths, that can be defined with \lstinline{minCompWinWidth} and \lstinline{maxCompWinWidth} (defaults are 5000 and 10000) parameters.
%\textit{\textbf{for real this part is to construct a sort of background of the signal, to compare the smaller windows to - ask to davide?}}

The so produced coverages are useful to compute a score for each detected region, applying a Maximum Likelihood Estimation (MLE) on the coverages between the sliding windows, assuming a Poisson distribution.

[PUT THE POISSON DISTRIBUTION AND THE LIKELIHOOD]


